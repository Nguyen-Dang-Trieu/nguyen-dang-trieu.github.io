---
title: Linux IO
date: 2025-1-21
categories: [Linux]
tags: [Device Driver, IO]
author: Trieu
image:
  path: assets/articles/2025/Buffer_IO_Direct_IO_mmap/2025-1-21-header.png
  alt: Buffer IO
---

## Má»Ÿ Ä‘áº§u
Äá»‘i vá»›i má»™t á»©ng dá»¥ng (hay má»™t tiáº¿n trÃ¬nh trong há»‡ Ä‘iá»u hÃ nh), khÃ´ng gian bá»™ nhá»› Ä‘Æ°á»£c chia thÃ nh 2 pháº§n:
- KhÃ´ng gian háº¡t nhÃ¢n **(Kernel-space)**: Ä‘Æ°á»£c chia sáº½ vá»›i cÃ¡c tiáº¿n trÃ¬nh khÃ¡c.
- KhÃ´ng gian ngÆ°á»i dÃ¹ng **(User-space)**: riÃªng Ä‘á»‘i vá»›i má»—i tiáº¿n trÃ¬nh.

Cáº£ hai Ä‘á»u náº±m trong khÃ´ng gian Ä‘á»‹a chá»‰ áº£o **(Virtual Memory)**. Tiáº¿n trÃ¬nh ngÆ°á»i dÃ¹ng khÃ´ng thá»ƒ trá»±c tiáº¿p truy cáº­p vÃ o khÃ´ng gian kernel. Thay vÃ o Ä‘Ã³, nÃ³ chá»‰ cÃ³ quyá»n truy cáº­p vÃ o 
khÃ´ng gian ngÆ°á»i dÃ¹ng **(User-space)** vÃ  cáº§n sao chÃ©p dá»¯ liá»‡u vÃ o khÃ´ng gian kernel thÃ´ng qua cÆ¡ cháº¿ do há»‡ Ä‘iá»u hÃ nh cung cáº¥p (nhÆ° cÃ¡c lá»i gá»i há»‡ thá»‘ng - **System call**). Sau Ä‘Ã³, kernel 
sáº½ xá»­ lÃ½ dá»¯ liá»‡u theo yÃªu cáº§u cá»§a tiáº¿n trÃ¬nh.

## IO lÃ  gÃ¬

Trong há»‡ thá»‘ng mÃ¡y tÃ­nh, **I/O (Input/Output)** cÃ³ nghÄ©a lÃ  Ä‘áº§u vÃ o vÃ  Ä‘áº§u ra. TÃ¹y theo Ä‘á»‘i tÆ°á»£ng hoáº¡t Ä‘á»™ng, I/O cÃ³ thá»ƒ Ä‘Æ°á»£c phÃ¢n loáº¡i thÃ nh nhiá»u mÃ´ hÃ¬nh khÃ¡c nhau nhÆ°: I/O Ä‘Ä©a, I/O máº¡ng, 
I/O Ã¡nh xáº¡ bá»™ nhá»›, I/O trá»±c tiáº¿p, I/O cÆ¡ sá»Ÿ dá»¯ liá»‡u, v.v. Báº¥t ká»³ há»‡ thá»‘ng nÃ o cÃ³ cÃ¡c kiá»ƒu Ä‘áº§u vÃ o vÃ  Ä‘áº§u ra Ä‘á»u cÃ³ thá»ƒ Ä‘Æ°á»£c coi lÃ  má»™t **há»‡ thá»‘ng I/O**. CÃ³ thá»ƒ nÃ³i, I/O chÃ­nh lÃ  kÃªnh trao 
Ä‘á»•i dá»¯ liá»‡u vÃ  cáº§u ná»‘i tÆ°Æ¡ng tÃ¡c giá»¯a con ngÆ°á»i ğŸ™â€â™‚ï¸ vÃ  mÃ¡y tÃ­nh ğŸ’» trong toÃ n bá»™ há»‡ Ä‘iá»u hÃ nh. ÄÃ¢y lÃ  má»™t khÃ¡i niá»‡m phá»• quÃ¡t, khÃ´ng phá»¥ thuá»™c vÃ o ngÃ´n ngá»¯ láº­p trÃ¬nh hay cÃ´ng nghá»‡ phÃ¡t 
triá»ƒn cá»¥ thá»ƒ.

Trong cÃ¡c há»‡ thá»‘ng ngÃ y nay, I/O Ä‘Ã³ng vai trÃ² quan trá»ng hÃ ng Ä‘áº§u. CÃ¡c há»‡ thá»‘ng hiá»‡n Ä‘áº¡i thÆ°á»ng pháº£i xá»­ lÃ½ khá»‘i lÆ°á»£ng lá»›n tá»‡p tin vÃ  cÃ¡c hoáº¡t Ä‘á»™ng cÆ¡ sá»Ÿ dá»¯ liá»‡u phá»©c táº¡p. Nhá»¯ng hoáº¡t 
Ä‘á»™ng nÃ y phá»¥ thuá»™c nhiá»u vÃ o hiá»‡u suáº¥t I/O cá»§a há»‡ thá»‘ng, vÃ  Ä‘Ã¢y thÆ°á»ng lÃ  nguyÃªn nhÃ¢n chÃ­nh gÃ¢y ra táº¯c ngháº½n hiá»‡u nÄƒng. Náº¿u hiá»‡u suáº¥t I/O khÃ´ng Ä‘á»§ cao, toÃ n bá»™ há»‡ thá»‘ng sáº½ bá»‹ cháº­m láº¡i, 
báº¥t ká»ƒ CPU hay bá»™ nhá»› cÃ³ máº¡nh Ä‘áº¿n Ä‘Ã¢u.

Äá»ƒ cáº£i thiá»‡n hiá»‡u suáº¥t I/O, cÃ¡c giáº£i phÃ¡p tá»‘i Æ°u hÃ³a Ä‘Ã£ Ä‘Æ°á»£c Ã¡p dá»¥ng, cháº³ng háº¡n nhÆ°:
- Bá»• sung bá»™ nhá»› Ä‘á»‡m trong kiáº¿n trÃºc há»‡ thá»‘ng nháº±m giáº£m Ä‘á»™ trá»… vÃ  tÄƒng tá»‘c Ä‘á»™ pháº£n há»“i.
- Thay tháº¿ á»• cá»©ng cÆ¡ há»c (HDD) truyá»n thá»‘ng báº±ng á»• Ä‘Ä©a thá»ƒ ráº¯n (SSD) Ä‘á»ƒ tÄƒng tá»‘c Ä‘á»™ truy cáº­p dá»¯ liá»‡u á»Ÿ cáº¥p Ä‘á»™ pháº§n cá»©ng.
  
CÃ³ thá»ƒ nÃ³i, pháº§n lá»›n khÃ´ng gian tá»‘i Æ°u hÃ³a há»‡ thá»‘ng náº±m á»Ÿ viá»‡c cáº£i thiá»‡n liÃªn káº¿t I/O, bá»Ÿi vÃ¬ Ä‘Ã¢y thÆ°á»ng lÃ  **Ä‘iá»ƒm ngháº½n chÃ­nh**. Trong khi Ä‘Ã³, hiá»‡u suáº¥t cá»§a CPU vÃ  bá»™ nhá»› hiáº¿m khi lÃ  nguyÃªn
nhÃ¢n gÃ¢y ra táº¯c ngháº½n trong há»‡ thá»‘ng hiá»‡n Ä‘áº¡i.

## Reference
- https://everything2.com/title/caller+vs+callee
